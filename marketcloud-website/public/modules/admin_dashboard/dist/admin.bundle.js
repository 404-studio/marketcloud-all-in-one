!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){"use strict";__webpack_require__(1)},function(module,exports,__webpack_require__){"use strict";!function(){function resolveApps($http){return $http({url:"/applications/list/",method:"GET"})}function resolveSingleApp($route,$app){return $app.getById($route.current.params.id)}var app=angular.module("AdminDashboard",["ngRoute","ngclipboard","angular-loading-bar"]);window.API_BASE_URL="https://api.marketcloud.studio404.net";__webpack_require__(2)(app),__webpack_require__(3)(app),__webpack_require__(4)(app),__webpack_require__(5)(app),__webpack_require__(6)(app),__webpack_require__(7)(app),__webpack_require__(8)(app),__webpack_require__(9)(app),__webpack_require__(10)(app),__webpack_require__(11)(app),__webpack_require__(12)(app),__webpack_require__(14)(app),__webpack_require__(15)(app);app.config(["$locationProvider",function($locationProvider){$locationProvider.hashPrefix("")}]),app.run(function($rootScope,$route){$rootScope.$on("$routeChangeSuccess",function(){angular.copy($route.current.$$route);$route.current.locals.application&&($rootScope.application=angular.copy($route.current.locals.application))})}),app.factory("$app",["$http","$q",function($http,$q){return{apps:{},getById:function(id){if(this.apps[id])return $q.when(this.apps[id]);var that=this;return $http({url:"/applications/list/"+Number(id),method:"GET"}).then(function(response){return that.apps[id]=response.data.data,$q.when(that.apps[id])})},clearAppCache:function(id){delete this.apps[id]}}}]),app.factory("BillingPlans",function(){var BILLING_PLANS={free:{name:"free",id:"free",price_monthly:0,price_yearly:0,api_calls_quota_max:"5000",storage:.5},"month-19":{name:"cumulus",id:"month-19",price_monthly:19,price_yearly:190,api_calls_quota_max:"100000",storage:1},"month-49":{name:"stratus",id:"month-49",price_monthly:49,price_yearly:490,api_calls_quota_max:"450000",storage:2},"month-99":{name:"nimbo stratus",id:"month-99",price_monthly:99,price_yearly:990,api_calls_quota_max:"1500000",storage:5}};return BILLING_PLANS}),app.factory("User",function(){var element=$("#JSONUserData"),json=JSON.parse(element.text());return console.log("The user is ",json),json}),app.config(function($routeProvider){$routeProvider.when("/",{name:"home",templateUrl:"/modules/admin_dashboard/templates/applications.html",controller:"ApplicationsController",resolve:{applications:["$http",resolveApps]}}).when("/applications/:id",{redirectTo:"/applications/:id/overview"}).when("/applications/:id/overview",{name:"overview",templateUrl:"/modules/admin_dashboard/templates/application_overview.html",controller:"ApplicationOverviewController",resolve:{application:["$route","$app",resolveSingleApp]}}).when("/applications/:id/billing",{name:"billing",templateUrl:"/modules/admin_dashboard/templates/application_billing.html",controller:"ApplicationBillingController",resolve:{application:["$route","$app",resolveSingleApp],account:["$http",function(http){return http({method:"GET",url:"/account/get"})}]}}).when("/applications/:id/settings",{name:"settings",templateUrl:"/modules/admin_dashboard/templates/application_settings.html",controller:"ApplicationSettingsController",resolve:{application:["$route","$app",resolveSingleApp]}}).when("/applications/:id/deploy",{name:"deploy",templateUrl:"/modules/admin_dashboard/templates/application_deploy.html",controller:"DeployController",resolve:{application:["$route","$app",resolveSingleApp]}}).when("/applications/:id/integrations",{name:"integrations",templateUrl:"/modules/admin_dashboard/templates/application_integrations.html",controller:"IntegrationsController",resolve:{application:["$route","$app",resolveSingleApp]}}).when("/applications/:id/webhooks",{name:"webhooks",templateUrl:"/modules/admin_dashboard/templates/application_webhooks.html",controller:"WebhooksController",resolve:{application:["$route","$app",resolveSingleApp],webhooks:["$http","$route",function($http,$route){return $http({method:"GET",url:"/applications/"+$route.current.params.id+"/webhooks"})}]}}).when("/applications/:id/collaborators",{name:"collaborators",templateUrl:"/modules/admin_dashboard/templates/application_collaborators.html",controller:"CollaboratorsController",resolve:{application:["$route","$app",resolveSingleApp],collaborators:["$http","$route",function($http,$route){return $http({method:"GET",url:"/applications/"+$route.current.params.id+"/collaborators"})}]}}).when("/applications/:id/acl",{name:"acl",templateUrl:"/modules/admin_dashboard/templates/application_roles.html",controller:"ACLController",resolve:{application:["$route","$app",resolveSingleApp],roles:["$http","$route",function($http,$route){return $http({method:"GET",url:"/applications/"+$route.current.params.id+"/roles"})}]}}).when("/applications/:id/acl/new",{name:"acl",templateUrl:"/modules/admin_dashboard/templates/new_role.html",controller:"NewRoleController",resolve:{application:["$route","$app",resolveSingleApp]}}).when("/applications/:id/acl/:roleId/edit",{name:"acl",templateUrl:"/modules/admin_dashboard/templates/edit_role.html",controller:"EditRoleController",resolve:{application:["$route","$app",resolveSingleApp],role:["$route","$http",function($route,$http){return $http({method:"GET",url:"/applications/"+$route.current.params.id+"/roles/"+$route.current.params.roleId})}]}}).when("/new",{name:"create",templateUrl:"/modules/admin_dashboard/templates/application_create.html",controller:"ApplicationsCreateController"}).otherwise({redirectTo:"/"})})}()},function(module,exports){"use strict";module.exports=function(app){app.directive("fallbackSrc",function(){return{link:function(scope,element,attrs){element.bind("error",function(){attrs.src!==attrs.fallbackSrc&&attrs.$set("src",attrs.fallbackSrc)})}}})}},function(module,exports){"use strict";module.exports=function(app){var ApplicationController=["$scope",function(scope){this.$onInit=function(){scope.application=this.applicationData},scope.percentage=function(app){var v=app.api_calls_quota_left,t=app.api_calls_quota_max;return v/t*100}}];app.component("application",{templateUrl:"/modules/admin_dashboard/src/components/application/application.component.html",controller:ApplicationController,bindings:{applicationData:"="}})}},function(module,exports){"use strict";module.exports=function(app){app.controller("NavigationController",["$scope","$route","$rootScope",function($scope,$route,$rootScope){$scope.$on("$dashboardSectionChange",function($event,args){$scope.currentSection=args.section,$scope.showNavigation="home"!==$scope.currentSection&&"create"!==$scope.currentSection})}])}},function(module,exports){"use strict";module.exports=function(app){app.controller("ApplicationsController",["$scope","applications","$location","$rootScope",function($scope,applications,location,$rootScope){$scope.applications=applications.data.data,$rootScope.$broadcast("$dashboardSectionChange",{section:"home"}),$scope.filterApps=function(){""===$scope.q&&($scope.applications=applications.data.data),$scope.applications=$scope.applications.filter(function(a){return a.name.toLowerCase().indexOf($scope.q.toLowerCase())>-1})},$scope.isNullOrUndefined=function(value){return null===value||"undefined"==typeof value}}]),app.controller("ApplicationsCreateController",["$scope","$http","Models","$location","$rootScope",function(scope,http,Models,location,$rootScope){scope.application={},$rootScope.$broadcast("$dashboardSectionChange",{section:"create"}),scope.create=function(){scope._invalid=null;var validation=Models.Application.validate(scope.application);!1===validation.valid&&(scope._invalid=validation.invalidPropertyName),http({method:"POST",url:"/applications",data:scope.application}).then(function(response){notie.alert(1,"Application created",1.5),location.path("/")}).catch(function(error){notie.alert(3,"An error has occurred, please try again",1.5)})}}]),app.controller("ApplicationOverviewController",["$scope","$http","application","$rootScope",function(scope,http,application,$rootScope){$rootScope.application=application,http({url:"/applications/"+application.id+"/activity",method:"GET",timeout:2e3}).then(function(response){scope.activities=response.data.data}).catch(function(error){notie.alert(3,"Unable to load application logs",1.5)}),$rootScope.$broadcast("$dashboardSectionChange",{section:"overview"}),scope.kilobytesToGigabytes=function(kb){return kb/1024/1024},scope.application.renew_date,scope.getMethodCSSClass=function(a){var cls=null;switch(a.method){case"GET":cls="label-success";break;case"POST":cls="label-info";break;case"PUT":cls="label-warning";break;case"PATCH":cls="label-warning";break;case"DELETE":cls="label-danger";break;default:cls="label-success"}return cls}}]),app.controller("ApplicationActivitiesController",["$scope","$http","application","$rootScope",function(scope,http,application,$rootScope){$rootScope.application=application}]),app.controller("ApplicationSettingsController",["$scope","application","$http","$location","$rootScope","BillingPlans",function($scope,application,$http,$location,$rootScope,BillingPlans){$rootScope.application=application,$scope.application=application,$rootScope.$broadcast("$dashboardSectionChange",{section:"settings"}),$scope.plans=BillingPlans,console.log($scope.plans),$scope.currentPlan=null;for(var k in BillingPlans)$scope.application.plan_name===BillingPlans[k].name&&($scope.currentPlan=BillingPlans[k]);console.log("Current plan is ",$scope.currentPlan),$scope.updateApplication=function(){var update={url:$scope.application.url,name:$scope.application.name};$http.put("/applications/"+$scope.application.id,update).then(function(response){notie.alert(1,"The application has been updated.",1.5)}).catch(function(error){notie.alert(3,"An error has occurred. Please try again.",1.5)})},$scope.deleteApplication=function(){notie.confirm("Do you really want to delete the application? It is not reversible!","Confirm","Cancel",function(){$http.delete("/applications/"+$scope.application.id).then(function(response){notie.alert(1,"The application has been deleted.",1.5),$location.path("/")}).catch(function(response){notie.alert(3,"An error has occurred, please try again.",1.5)})})},$scope.regenerateKeys=function(){notie.confirm("Do you really want to update the application's keys?","Confirm","Cancel",function(){$http.put("/applications/"+$scope.application.id+"/regenerateKeys").then(function(response){$scope.application.public_key=response.data.data.public_key,$scope.application.secret_key=response.data.data.secret_key,notie.alert(1,"Keys regenerated correctly.",1.5)}).catch(function(response){notie.alert(3,"An error has occurred. Please retry",1.5)})})}}])}},function(module,exports){"use strict";module.exports=function(app){app.controller("DeployController",["$scope","$rootScope","application",function(scope,$rootScope,application){scope.selectedTemplate=null,$rootScope.application=application,$rootScope.$broadcast("$dashboardSectionChange",{section:"deploy"}),scope.getHerokuURL=function(){var str="https://heroku.com/deploy";return str+="?template="+scope.selectedTemplate,str+="&env[MARKETCLOUD_PUBLIC_KEY]="+encodeURIComponent(scope.application.public_key),str+="&env[MARKETCLOUD_SECRET_KEY]="+encodeURIComponent(scope.application.secret_key)}}])}},function(module,exports){"use strict";module.exports=function(app){app.controller("WebhooksController",["$scope","$http","webhooks","application","$rootScope",function(scope,http,webhooks,application,$rootScope){$rootScope.application=application,scope.mode=null,scope.error=null,scope.invalidPropertyName=null,scope.application=application,scope.webhooks=webhooks.data.data,$rootScope.$broadcast("$dashboardSectionChange",{section:"webhooks"}),scope.newWebhook={};var webhookMethods=["create","update","delete"],webhookResources=["addresses","brands","carts","categories","collections","contents","coupons","invoices","files","orders","paymentMethods","products","promotions","stores","taxes","users","variables"];scope.events=[],webhookResources.forEach(function(resource){webhookMethods.forEach(function(method){scope.events.push(resource+"."+method)})}),scope.events.splice(scope.events.indexOf("orders.delete")+1,0,"payments.create"),scope.load=function(){http({method:"GET",url:"/applications/"+scope.application.id+"/webhooks"}).then(function(response){console.log("LOAD",response),scope.webhooks=response.data.data}).catch(function(response){notie.alert(2,"An error has occurred while reloading webhooks.",1)})},scope.edit=function(hook){scope.newWebhook=hook,scope.showUpdateModal()},scope.showUpdateModal=function(){scope.mode="update",$("#newWebhookModal").modal("show")},scope.showCreateModal=function(){scope.mode="create",scope.newWebhook={},$("#newWebhookModal").modal("show")},scope.validateWebhook=function(){return scope.error=null,scope.invalidPropertyName=null,!1===scope.validateUrl()?(scope.error="The URL is not valid. Remember to specify the protocol http:// or https:// at the beginning.",scope.invalidPropertyName="url",!1):!!scope.newWebhook.event||(scope.error="Please select a valid event from the menu",scope.invalidPropertyName="event",!1)},scope.saveWebhook=function(){scope.validateWebhook()&&http({method:"POST",url:"/applications/"+scope.application.id+"/webhooks",data:scope.newWebhook}).then(function(response){notie.alert(1,"Webhook correctly created",1),scope.newWebhook={},$("#newWebhookModal").modal("hide"),scope.load()}).catch(function(response){notie.alert(3,"An error has occurred, webhook not created",1),scope.newWebhook={}})},scope.validateUrl=function(){var regex=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[\/?#]\S*)?$/i;return regex.test(scope.newWebhook.url)},scope.updateWebhook=function(){if(scope.validateWebhook()){var update={event:scope.newWebhook.event,url:scope.newWebhook.url};http({method:"PUT",url:"/applications/"+scope.application.id+"/webhooks/"+scope.newWebhook.id,data:update}).then(function(response){notie.alert(1,"Webhook correctly updated",1),scope.newWebhook={}}).catch(function(response){notie.alert(3,"An error has occurred, webhook not updated",1)})}},scope.delete=function(hook){http({method:"DELETE",url:"/applications/"+scope.application.id+"/webhooks/"+hook.id}).then(function(response){notie.alert(1,"Webhook correctly deleted",1),scope.load()}).catch(function(response){notie.alert(3,"An error has occurred, webhook not deleted",1)})}}])}},function(module,exports){"use strict";module.exports=function(app){app.controller("IntegrationsController",function($scope,$http,application,$rootScope){$rootScope.application=application,$scope.integrations=[{name:"braintree",tags:["payments"],image:"/img/3rdparty/braintree-logo.jpg",description:"Accept cards and Paypal on web and mobile almost anywhere.",links:{view:"/documentation/integrations/braintree"}},{name:"stripe",tags:["payments"],image:"/img/3rdparty/stripe.png",description:"Web and mobile payments. Built for developers.",links:{view:"/documentation/integrations/stripe"}},{name:"facebook",tags:["authentication"],image:"/img/3rdparty/facebook.png",description:"Z u c c the C u c c",links:{view:"/documentation/guides/facebook-login"}}],$rootScope.$broadcast("$dashboardSectionChange",{section:"integrations"})}),app.controller("IntegrationStripeController",function($scope,$http,$routeParams,StripeIntegration){console.log("Integration status",StripeIntegration),StripeIntegration?($scope.isIntegrationInstalled=!0,$scope.StripeIntegration=StripeIntegration):$scope.isIntegrationInstalled=!1,$scope.currentApplication=window.current_application,$scope.toggleIntegration=function(){return alert($scope.StripeIntegration.isActive),$http({method:"PUT",url:"/applications/"+window.current_application.id+"/integrations/stripe",data:{isActive:$scope.StripeIntegration.isActive}}).then(function(response){notie.alert(1,"Integration correctly updated",1)}).catch(function(response){notie.alert(3,"An error has occurred. Integration not updated",1)})}}),app.controller("IntegrationBraintreeController",function($scope,$http,$routeParams,BraintreeIntegration){$scope.displayCredentialsForm=!1,$scope.currentApplication=window.current_application,$scope.braintreeConfiguration=BraintreeIntegration.data.data,$scope.braintreeUpdate=angular.copy(BraintreeIntegration.data.data),$scope.braintreeUpdate.hasOwnProperty("isActive")||($scope.braintreeUpdate.isActive=!1),$scope.toggleCredentialsForm=function(){$scope.displayCredentialsForm=!$scope.displayCredentialsForm},$scope.showModal=function(){$("#BraintreeCredentialsModal").modal("show")},$scope.toggleIntegration=function(){return $http({method:"PUT",url:"/applications/"+window.current_application.id+"/integrations/braintree",data:{isActive:$scope.braintreeConfiguration.isActive}}).then(function(response){notie.alert(1,"Integration correctly updated",1)}).catch(function(response){notie.alert(3,"An error has occurred. Integration not updated",1)})},$scope.saveBraintreeConfiguration=function(){var payload={environment:$scope.braintreeUpdate.environment,isActive:$scope.braintreeUpdate.isActive};$scope.braintreeUpdate.merchantId&&$scope.braintreeUpdate.publicKey&&$scope.braintreeUpdate.privateKey&&(payload.merchantId=$scope.braintreeUpdate.merchantId,payload.publicKey=$scope.braintreeUpdate.publicKey,payload.privateKey=$scope.braintreeUpdate.privateKey),console.log("PUTTING",payload),$http({method:"PUT",url:"/applications/"+window.current_application.id+"/integrations/braintree",data:payload}).then(function(response){notie.alert(1,"Integration correctly updated",1),$("#BraintreeCredentialsModal").modal("hide"),$scope.braintreeConfiguration=angular.copy({environment:payload.environment,isActive:payload.isActive})}).catch(function(response){notie.alert(3,"An error has occurred. Integration not updated",1)})}})}},function(module,exports){"use strict";module.exports=function(app){app.controller("CollaboratorsController",["$scope","$http","collaborators","application","$rootScope",function(scope,http,collaborators,application,$rootScope){$rootScope.application=application,scope.mode=null,scope.application=application,scope.collaborators=collaborators.data.data,$rootScope.$broadcast("$dashboardSectionChange",{section:"collaborators"}),scope.load=function(){http({method:"GET",url:"/applications/"+scope.application.id+"/collaborators"}).then(function(response){scope.collaborators=response.data.data}).catch(function(response){notie.alert(2,"An error has occurred while reloading collaborators.",1)})},scope.showCreateModal=function(){scope.mode="create",$("#newCollaboratorModal").modal("show")},scope.saveCollaborator=function(){http({method:"POST",url:"/applications/"+scope.application.id+"/collaborators",data:scope.newCollaborator}).then(function(response){notie.alert(1,"Collaborator correctly created",1.5),scope.newCollaborator={},$("#newCollaboratorModal").modal("hide"),scope.load()}).catch(function(response){notie.alert(3,"An error has occurred, collaborator not created",1.5),scope.newCollaborator={}})},scope.updateCollaborator=function(collaborator){http({method:"PUT",url:"/applications/"+scope.application.id+"/collaborators/"+collaborator.email,data:{role:collaborator.role}}).then(function(response){notie.alert(1,"Collaborator correctly updated",1)}).catch(function(response){notie.alert(3,"An error has occurred, collaborator not updated",1),scope.newCollaborator={}})},scope.delete=function(collaborator){http({method:"DELETE",url:"/applications/"+scope.application.id+"/collaborators/"+collaborator.email}).then(function(response){notie.alert(1,"Collaborator correctly deleted",1),scope.load()}).catch(function(response){notie.alert(3,"An error has occurred, collaborator not deleted",1)})}}])}},function(module,exports){"use strict";module.exports=function(app){app.controller("ApplicationBillingController",["$scope","$http","application","$rootScope","$app","account",function(scope,http,application,rootScope,$app,account){rootScope.application=application,scope.application=application,rootScope.$broadcast("$dashboardSectionChange",{section:"billing"}),scope.step=1,scope.selected_plan=null,scope.error=null,scope.invalidPropertyName=null,scope.card={},scope.creditCardFormState="idle",scope.goToStep=function(step){scope.step=step},scope.account=account.data.data,scope.selectPlan=function(plan_id){scope.plans.forEach(function(plan){plan.id===plan_id&&(scope.selected_plan=plan)}),console.log("selected_plan",scope.selected_plan),scope.goToStep(2)};scope.updateApplicationSubscription=function(){scope.creditCardFormState="processing",http({method:"PUT",url:"/applications/"+application.id+"/billing",data:{plan_id:scope.selected_plan.id}}).then(function(response){$app.clearAppCache(application.id),scope.goToStep(3),scope.creditCardFormState="success"}).catch(function(error){console.log(error),scope.error=error,notie.alert(2,error.data.errors[0].message||"Payment failed, please check your billing information."),scope.creditCardFormState="error"})},scope.canSeeStartupPlan=function(){var eligibleAccounts=["cikkense@gmail.com","info@stranomaverde.it"];return eligibleAccounts.indexOf(scope.account.email)>-1},scope.plans=[{name:"free",id:"free",price_monthly:0,price_yearly:0,api_calls:"5000",storage:"0.5"},{name:"startup",id:"startup_plan_10_monthly",price_monthly:10,price_yearly:120,api_calls:"50000",storage:"1"},{name:"cumulus",id:"month-19",price_monthly:19,price_yearly:190,api_calls:"100K",storage:"1"},{name:"stratus",id:"month-49",price_monthly:49,price_yearly:490,api_calls:"450K",storage:"2"},{name:"nimbo stratus",id:"month-99",price_monthly:99,price_yearly:990,api_calls:"1500K",storage:"5"}]}])}},function(module,exports,__webpack_require__){"use strict";module.exports=function(app){app.controller("Loading",["$scope","$interval",function(scope,interval){scope.counter=1,interval(function(){scope.counter++,scope.counter>3&&(scope.counter=1)},600)}]),app.component("loading",{templateUrl:"/modules/shared/js/components/loading.component.html",controller:"Loading",bindings:{}})}},function(module,exports,__webpack_require__){"use strict";module.exports=function(app){var Schematic=__webpack_require__(13);app.factory("Models",function(){var ApplicationSchema=new Schematic.Schema("Application",{name:{type:"string",required:!0,min:3,max:140},url:{type:"string",min:6,max:140},ecommerce_category:{type:"string"},reason:{type:"string",whitelist:["myself","client"]}});return{Application:ApplicationSchema}})}},function(module,exports,__webpack_require__){"use strict";function validateAgainstSchema(value,schema){if(schema.hasOwnProperty("required")){if(schema.required===!0&&("undefined"==typeof value||null===value))return{valid:!1,failedValidator:"required"};if(schema.required!==!0&&("undefined"==typeof value||null===value))return{valid:!0}}if("object"===_typeof(schema.type))return schema.type.validateRecursive(value);if("string"==typeof schema.type){for(var rule in schema){if(!Schematic.Validators.hasOwnProperty(rule))throw new Error("Schematic cannot find validator named "+rule);if(!1===Schematic.Validators[rule](value,schema[rule]))return{valid:!1,failedValidator:rule}}return{valid:!0}}throw console.log("Lo schema",schema,"Ha un type del cazzo"),new Error("Schematic error, type constraint accepts only strings and Schematic.Schema values.")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},Schematic={};Schematic.Validators={},Schematic.validate=function(schema,object){var s=new Schematic.Schema("temp",schema);return s.validate(object)},Schematic.Validators.type=function(toTest,wanted){switch(wanted){case"array":return toTest instanceof Array;case"number":return"number"==typeof toTest;case"string":return"string"==typeof toTest;case"object":return"object"===("undefined"==typeof toTest?"undefined":_typeof(toTest));case"boolean":return"boolean"==typeof toTest;default:throw new Error("Schematic error, Schematic.Validators.type encountered a not supported type ("+("undefined"==typeof toTest?"undefined":_typeof(toTest))+").")}},Schematic.Validators.elements=function(elements,schema){if(!(elements instanceof Array))throw new Error("Schematic error, Schematic.Validators.elements can be applied only for Array types");if("object"!==("undefined"==typeof schema?"undefined":_typeof(schema)))throw new Error("Schematic error, Schematic.Validators.elements(<Array>,<SchemaObject>)");var t=null,result=!0;return elements.forEach(function(e){t=validateAgainstSchema(e,schema),!1===t.valid&&(result=!1)}),result},Schematic.Validators.required=function(value){return"undefined"!=typeof value&&null!==value},Schematic.Validators.whitelist=function(value,whitelist){return!(whitelist.indexOf(value)<0)},Schematic.Validators.blacklist=function(value,blacklist){return blacklist.indexOf(value)<0},Schematic.Validators.min=function(value,min){if("number"==typeof value)return value>=min;if("string"==typeof value)return value.length>=min;if(value instanceof Array)return value.length>=min;throw new Error("Schematic.Validators.min works only with numbers, strings and arrays")},Schematic.Validators.max=function(value,max){if("number"==typeof value)return value<=max;if("string"==typeof value)return value.length<=max;if(value instanceof Array)return value.length<=max;throw new Error("Schematic.Validators.max works onlywith numbers, strings and arrays")},Schematic.Schema=function(name,schema){if("string"!=typeof name)throw new Error("First argument of Schematic.Schema must be string");if("object"!==("undefined"==typeof schema?"undefined":_typeof(schema)))throw new Error("Second argumentm of Schematic.Schema must be an object");this.name=name,this.schema=schema};var SchemaStack=[],PropertyStack=[];Schematic.Schema.prototype.validate=function(object){if("undefined"==typeof object||null===object)throw new Error("Schematic error, null or undefined cannot be validated");if(object instanceof Array)return{valid:!1,failedValidator:"type",invalidPropertyName:"Object"};SchemaStack=[],PropertyStack=[],SchemaStack.push(this.name);var r={valid:!0};for(var property in this.schema){if(PropertyStack.push(property),object.hasOwnProperty(property)||this.schema[property].required!==!0||(r={valid:!1,failedValidator:"missingRequiredProperty",invalidPropertyName:property}),object.hasOwnProperty(property)&&(r=validateAgainstSchema(object[property],this.schema[property])),r.valid===!1)return"undefined"==typeof r.invalidPropertyName&&(r.invalidPropertyName=PropertyStack.join(".")),r;PropertyStack.pop()}return SchemaStack.pop(),r},Schematic.Schema.prototype.getPropertyNames=function(){if(Object.keys)return Object.keys(this.schema)},Schematic.Schema.prototype.validateRecursive=function(object){SchemaStack.push(this.name);var r={valid:!0};for(var property in object){if(PropertyStack.push(property),!this.schema.hasOwnProperty(property))return{valid:!1,failedValidator:"propertyNotInSchema",invalidPropertyName:property};if(r=validateAgainstSchema(object[property],this.schema[property]),r.valid===!1)return"undefined"==typeof r.invalidPropertyName&&(r.invalidPropertyName=PropertyStack.join(".")),r;PropertyStack.pop()}return SchemaStack.pop(),r},"undefined"!=typeof window&&(window.Schematic=Schematic),module.exports=Schematic},function(module,exports){"use strict";module.exports=function(app){app.factory("rolePresets",function(){function getCommonPublicProfile(){return{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1}}function getAllFalseProfile(){return{list:!1,findOne:!1,getById:!1,create:!1,update:!1,delete:!1}}function getCommonUserProfile(){return{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1}}function getCommonAdminProfile(){return{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0}}var publicAccessMap={addresses:getAllFalseProfile(),brands:getCommonPublicProfile(),carts:{list:!1,findOne:!1,getById:!0,patch:!0,create:!0,update:!0,checkout:!0,delete:!1},categories:getCommonPublicProfile(),collections:getCommonPublicProfile(),contents:getCommonPublicProfile(),coupons:getAllFalseProfile(),promotions:getCommonPublicProfile(),currencies:getCommonPublicProfile(),orders:{list:!1,findOne:!1,getById:!1,create:!0,update:!1,delete:!1},paymentMethods:getCommonPublicProfile(),invoices:getAllFalseProfile(),products:getCommonPublicProfile(),shippings:getCommonPublicProfile(),stores:getCommonPublicProfile(),taxes:getCommonPublicProfile(),users:{list:!1,findOne:!1,getById:!1,create:!0,update:!1,delete:!1,authenticate:!0},variables:getCommonPublicProfile()},userAccessMap={addresses:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},brands:{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1},carts:{list:!0,findOne:!1,getById:!0,patch:!0,create:!0,update:!0,checkout:!0,delete:!0},categories:{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1},collections:{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1},contents:{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1},coupons:getAllFalseProfile(),promotions:{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1},currencies:{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1},orders:{list:!0,findOne:!0,getById:!0,create:!0,update:!1,delete:!1},paymentMethods:{list:!0,findOne:!0,getById:!0,create:!0,update:!1,delete:!1},products:{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1},shippings:{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1},stores:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},taxes:{list:!0,findOne:!0,getById:!0,create:!1,update:!1,delete:!1},invoices:{list:!1,findOne:!1,getById:!1,create:!1,update:!1,delete:!1},users:{list:!1,findOne:!1,getById:!0,create:!0,update:!0,delete:!0,authenticate:!0},variables:getCommonUserProfile()},adminAccessMap={addresses:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},invoices:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},brands:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},carts:{list:!0,findOne:!0,getById:!0,create:!0,patch:!0,update:!0,checkout:!0,delete:!0},categories:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},collections:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},contents:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},coupons:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},promotions:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},currencies:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},orders:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},paymentMethods:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},products:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},shippings:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},stores:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},taxes:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0},users:{list:!0,findOne:!0,getById:!0,create:!0,update:!0,delete:!0,
authenticate:!0},variables:getCommonAdminProfile()};return{public:publicAccessMap,user:userAccessMap,admin:adminAccessMap}})}},function(module,exports){"use strict";module.exports=function(app){app.controller("EditRoleController",["$scope","$http","application","$rootScope","rolePresets","role","$location",function(scope,http,application,$rootScope,rolePresets,role,location){scope.application=application,$rootScope.$broadcast("$dashboardSectionChange",{section:"acl"}),$rootScope.application=application,scope.role=role.data.data,scope.preset_name="public",scope.errors={},scope.presets=rolePresets,scope.applyPreset=function(){if(!scope.presets.hasOwnProperty(scope.preset_name))return void console.log("THere is no preset named "+scope.preset_name);for(var k in scope.presets[scope.preset_name])scope.role.endpoints[k]=scope.presets[scope.preset_name][k]},scope.clearErrors=function(){scope.errors={}},scope.formHasErrors=function(){return console.log("KEYS"+Object.keys(scope.errors).length),Object.keys(scope.errors).length>0};var validateRole=function(){return scope.clearErrors(),scope.role.name.length>253?(scope.errors.name="Name too long",!1):!(scope.role.name.length<1)||(scope.errors.name="Name too short",!1)};scope.updateRole=function(){validateRole()&&http({method:"PUT",url:"/applications/"+scope.application.id+"/roles/"+scope.role.id,data:scope.role}).then(function(response){notie.alert(1,"Role successfuly created.",1.5),location.path("/applications/"+scope.application.id+"/acl")}).catch(function(error){notie.alert(2,"An error has occurred, please try again.",1.5)})}}]),app.controller("NewRoleController",["$scope","$http","application","$rootScope","rolePresets","$location",function(scope,http,application,$rootScope,rolePresets,location){scope.application=application,$rootScope.$broadcast("$dashboardSectionChange",{section:"acl"}),$rootScope.application=application,scope.preset_name="public",scope.errors={},scope.newRole={name:"",description:"",endpoints:angular.copy(rolePresets.public)},scope.presets=rolePresets,scope.applyPreset=function(){if(!scope.presets.hasOwnProperty(scope.preset_name))return void console.log("THere is no preset named "+scope.preset_name);for(var k in scope.presets[scope.preset_name])scope.newRole.endpoints[k]=scope.presets[scope.preset_name][k]},scope.clearErrors=function(){scope.errors={}},scope.formHasErrors=function(){return console.log("KEYS"+Object.keys(scope.errors).length),Object.keys(scope.errors).length>0};var validateRole=function(){return scope.clearErrors(),scope.newRole.name.length>253?(scope.errors.name="Name too long",!1):!(scope.newRole.name.length<1)||(scope.errors.name="Name too short",!1)};scope.saveRole=function(){validateRole()&&http({method:"POST",url:"/applications/"+scope.application.id+"/roles",data:scope.newRole}).then(function(response){notie.alert(1,"Role successfuly created.",1.5),location.path("/applications/"+scope.application.id+"/acl")}).catch(function(error){notie.alert(2,"An error has occurred, please try again.",1.5)})}}]),app.controller("ACLController",["$scope","$http","roles","application","$rootScope",function(scope,http,roles,application,$rootScope){$rootScope.$broadcast("$dashboardSectionChange",{section:"acl"}),scope.application=application,$rootScope.application=application,scope.roles=roles.data.data,scope.load=function(){http({method:"GET",url:"/applications/"+scope.application.id+"/roles"}).then(function(response){scope.roles=response.data.data}).catch(function(response){notie.alert(2,"An error has occurred while reloading roles.",1)})},scope.delete=function(role){http({method:"DELETE",url:"/applications/"+scope.application.id+"/roles/"+role.id}).then(function(response){notie.alert(1,"Role correctly deleted",1),scope.load()}).catch(function(response){notie.alert(3,"An error has occurred, role not deleted",1)})}}])}}]);